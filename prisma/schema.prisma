generator client {
  provider   = "prisma-client"
  output     = "../generated/prisma"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(cuid())
  steamId64 String   @unique

  personaName String?
  avatar      String?
  visibility  Int?      
  personaState Int?     // online/offline... 
  lastLogOff Int?
  timeCreated Int?
  locCountryCode String?

  lastSyncAt DateTime?
  
  ownedGames  OwnedGame[]

  createdAt DateTime @default(now())
}

model OwnedGame {
  id        String   @id @default(cuid())

  appid     Int
  name      String
  icon      String?        // Steam img_icon_url
  genre     String?        // nullable, enrich later

  playtimeForever Int      // minutes
  playtime2Weeks  Int?     // minutes
  lastPlayedAt    DateTime?

  achievementsUnlocked Int?
  achievementsTotal    Int?

  user     User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId  String

  @@unique([userId, appid])
}
